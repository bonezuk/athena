import numpy as np
from scipy import signal
import matplotlib.pyplot as plt

fs = 44100   # Sample rate, Hz

def plot_response(w, h, title):
    "Utility function to plot response functions"
    fig = plt.figure()
    ax = fig.add_subplot(111)
    ax.plot(w, 20*np.log10(np.abs(h)))
    ax.set_ylim(-40, 5)
    ax.grid(True)
    ax.set_xlabel('Frequency (Hz)')
    ax.set_ylabel('Gain (dB)')
    ax.set_title(title)

taps = [
	-0.017017251427, -0.041902073655, 0.014654654528, -0.003621756476,
	0.002907391750, -0.001327575706, -0.001413931337, -0.000767356491,
	0.001137042702, 0.001603126399, 0.000214671956, -0.001469836651,
	-0.001434147426, 0.000302791414, 0.001710551338, 0.001110002348,
	-0.000821438233, -0.001813179474, -0.000670039503, 0.001289173004,
	0.001751248061, 0.000139650181, -0.001669290923, -0.001529415249,
	0.000429590651, 0.001913809893, 0.001150067765, -0.000996464762,
	-0.002000866691, -0.000647298527, 0.001500789112, 0.001905043166,
	0.000051078356, -0.001901398362, -0.001632707273, 0.000581551642,
	0.002147171488, 0.001189341780, -0.001203467284, -0.002214640542,
	-0.000613471208, 0.001748932348, 0.002078228406, -0.000059183215,
	-0.002171926394, -0.001746020574, 0.000765066995, 0.002417647873,
	0.001227227237, -0.001450372623, -0.002460742710, -0.000565499021,
	0.002042935184, 0.002275456577, -0.000196910490, -0.002490993142,
	-0.001871770641, 0.000988779545, 0.002735425502, 0.001263103560,
	-0.001748504076, -0.002748411367, -0.000499104925, 0.002396285816,
	0.002503879385, -0.000370418448, -0.002873421903, -0.002013994345,
	0.001265348523, 0.003115638907, 0.001296577848, -0.002114693929,
	-0.003091678092, -0.000408274429, 0.002829268928, 0.002774683571,
	-0.000591998692, -0.003342020068, -0.002178962812, 0.001613771318,
	0.003581703957, 0.001327301979, -0.002574593881, -0.003512433291,
	-0.000284207455, 0.003373521001, 0.003105699248, -0.000880851809,
	-0.003932739266, -0.002377097302, 0.002064509894, 0.004171471998,
	0.001354766964, -0.003170069634, -0.004046844843, -0.000112217990,
	0.004081685863, 0.003526567337, -0.001268821740, -0.004706538242,
	-0.002626376878, 0.002669254665, 0.004950251016, 0.001378975963,
	-0.003974129327, -0.004758679322, 0.000133062645, 0.005047208387,
	0.004091285058, -0.001813413218, -0.005774581292, -0.002960196144,
	0.003524007009, 0.006040591081, 0.001399459632, -0.005125959024,
	-0.005770951859, 0.000500876281, 0.006454634156, 0.004907493319,
	-0.002630421597, -0.007363880751, -0.003447805058, 0.004829325986,
	0.007702080989, 0.001416109879, -0.006928414738, -0.007355997117,
	0.001101627104, 0.008723817991, 0.006224510585, -0.003992113364,
	-0.010018470081, -0.004258486424, 0.007084329913, 0.010595693753,
	0.001428642291, -0.010187547969, -0.010256062571, 0.002243171220,
	0.013061744427, 0.008780446274, -0.006727960849, -0.015451976290,
	-0.005944863141, 0.011976710506, 0.017045252608, 0.001437170284,
	-0.017998315178, -0.017467736347, 0.005237322649, 0.024924615122,
	0.016137693222, -0.015144012831, -0.033314470556, -0.011920233555,
	0.031095275054, 0.045107650672, 0.001441514673, -0.063720141975,
	-0.069661929549, 0.034481529554, 0.209831240309, 0.345393918693,
	0.345393918693, 0.209831240309, 0.034481529554, -0.069661929549,
	-0.063720141975, 0.001441514673, 0.045107650672, 0.031095275054,
	-0.011920233555, -0.033314470556, -0.015144012831, 0.016137693222,
	0.024924615122, 0.005237322649, -0.017467736347, -0.017998315178,
	0.001437170284, 0.017045252608, 0.011976710506, -0.005944863141,
	-0.015451976290, -0.006727960849, 0.008780446274, 0.013061744427,
	0.002243171220, -0.010256062571, -0.010187547969, 0.001428642291,
	0.010595693753, 0.007084329913, -0.004258486424, -0.010018470081,
	-0.003992113364, 0.006224510585, 0.008723817991, 0.001101627104,
	-0.007355997117, -0.006928414738, 0.001416109879, 0.007702080989,
	0.004829325986, -0.003447805058, -0.007363880751, -0.002630421597,
	0.004907493319, 0.006454634156, 0.000500876281, -0.005770951859,
	-0.005125959024, 0.001399459632, 0.006040591081, 0.003524007009,
	-0.002960196144, -0.005774581292, -0.001813413218, 0.004091285058,
	0.005047208387, 0.000133062645, -0.004758679322, -0.003974129327,
	0.001378975963, 0.004950251016, 0.002669254665, -0.002626376878,
	-0.004706538242, -0.001268821740, 0.003526567337, 0.004081685863,
	-0.000112217990, -0.004046844843, -0.003170069634, 0.001354766964,
	0.004171471998, 0.002064509894, -0.002377097302, -0.003932739266,
	-0.000880851809, 0.003105699248, 0.003373521001, -0.000284207455,
	-0.003512433291, -0.002574593881, 0.001327301979, 0.003581703957,
	0.001613771318, -0.002178962812, -0.003342020068, -0.000591998692,
	0.002774683571, 0.002829268928, -0.000408274429, -0.003091678092,
	-0.002114693929, 0.001296577848, 0.003115638907, 0.001265348523,
	-0.002013994345, -0.002873421903, -0.000370418448, 0.002503879385,
	0.002396285816, -0.000499104925, -0.002748411367, -0.001748504076,
	0.001263103560, 0.002735425502, 0.000988779545, -0.001871770641,
	-0.002490993142, -0.000196910490, 0.002275456577, 0.002042935184,
	-0.000565499021, -0.002460742710, -0.001450372623, 0.001227227237,
	0.002417647873, 0.000765066995, -0.001746020574, -0.002171926394,
	-0.000059183215, 0.002078228406, 0.001748932348, -0.000613471208,
	-0.002214640542, -0.001203467284, 0.001189341780, 0.002147171488,
	0.000581551642, -0.001632707273, -0.001901398362, 0.000051078356,
	0.001905043166, 0.001500789112, -0.000647298527, -0.002000866691,
	-0.000996464762, 0.001150067765, 0.001913809893, 0.000429590651,
	-0.001529415249, -0.001669290923, 0.000139650181, 0.001751248061,
	0.001289173004, -0.000670039503, -0.001813179474, -0.000821438233,
	0.001110002348, 0.001710551338, 0.000302791414, -0.001434147426,
	-0.001469836651, 0.000214671956, 0.001603126399, 0.001137042702,
	-0.000767356491, -0.001413931337, -0.001327575706, 0.002907391750,
	-0.003621756476, 0.014654654528, -0.041902073655, -0.017017251427
]

w, h = signal.freqz(taps, [1], worN=2000, fs=fs)
plot_response(w, h, "Filter")
plt.show()
