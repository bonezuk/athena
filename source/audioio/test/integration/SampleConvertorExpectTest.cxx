#include "gtest/gtest.h"
#include "gmock/gmock.h"

#include "engine/inc/FormatTypeFromFloat.h"

using namespace orcus;
using namespace engine;
using namespace testing;

//-------------------------------------------------------------------------------------------

TEST(SampleConvertorExpect,print)
{
	const tfloat64 c_sampleInput[12] = {
		 1.0, //  0: = 0x0007FFFF =  524287 =  1048574 =  1048574.0 / 1048574.0 =  1.0
		 0.8, //  1: = 0x00066666 =  419430 =   838860 =   838859.2 / 1048574.0 =  0.8 (  838859.2  838858=1.2  838860=0.8 )
		 0.6, //  2: = 0x0004CCCC =  314572 =   629144 =   629144.4 / 1048574.0 =  0.6 (  629144.4  629144=0.4  629146=1.6 )
		 0.4, //  3: = 0x00033333 =  209715 =   419430 =   419429.6 / 1048574.0 =  0.4 (  419429.6  419428=1.6  419430=0.4 )
		 0.2, //  4: = 0x00019999 =  104857 =   209714 =   209714.8 / 1048574.0 =  0.2 (  209714.8  209714=0.8  209716=1.2 )
		-0.2, //  5: = 0xFFFE6666 = -104858 =  -209716 =  -209715.2 / 1048576.0 = -0.2 ( -209715.2 -209714=1.2 -209716=0.8 )
		-0.4, //  6: = 0xFFFCCCCD = -209715 =  -419430 =  -419430.4 / 1048576.0 = -0.4 ( -419430.4 -419430=0.4 -419432=1.6 )
		-0.6, //  7: = 0xFFFB3333 = -314573 =  -629146 =  -629145.6 / 1048576.0 = -0.6 ( -629145.6 -629144=1.6 -629146=0.4 )
		-0.8, //  8: = 0xFFF9999A = -419430 =  -838860 =  -838860.8 / 1048576.0 = -0.8 ( -838860.8 -838860=0.8 -838862=1.2 )
		-1.0, //  9: = 0xFFF80000 = -524288 = -1048576 = -1048576.0 / 1048576.0 = -1.0
		 1.0, // 10: = 0x0007FFFF =  1.2
		-1.0  // 11: = 0xFFF80000 = -1.2
	};

	tint i,j;
	
	for(i=3;i<=32;i++)
	{
		tint shift = 4 - (i % 4);
		fprintf(stdout,"%d - Bit\n",i);
		for(j=0;j<12;j++)
		{
			tint x = sampleToInteger(c_sampleInput[j],i);
			fprintf(stdout,"%.1f 0x%08x 0x%08x\n",c_sampleInput[j],x,x << shift);
		}
		fprintf(stdout,"\n");
	}
}

//-------------------------------------------------------------------------------------------
