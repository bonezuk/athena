set(TIGER_INSTALL "${EXECUTABLE_OUTPUT_PATH}")
set(TIGER_BIN_INSTALL "${EXECUTABLE_OUTPUT_PATH}")

set(EXECUTABLE_OUTPUT_PATH "${TIGER_BIN_INSTALL}")
set(LIBRARY_OUTPUT_PATH "${EXECUTABLE_OUTPUT_PATH}")

message("Build directory structure")
message("${TIGER_BIN_INSTALL}")

file(MAKE_DIRECTORY "${TIGER_INSTALL}")
file(MAKE_DIRECTORY "${TIGER_BIN_INSTALL}")
file(MAKE_DIRECTORY "${TIGER_BIN_INSTALL}/imageformats")
file(MAKE_DIRECTORY "${TIGER_BIN_INSTALL}/platforms")
file(MAKE_DIRECTORY "${TIGER_BIN_INSTALL}/printsupport")

message("Copy Qt image formats")

function (copy_rename_plugin_files FILENAME PLUGIN_DIR)
	if (TIGER_DEBUG_BUILD)
		set(PLUGIN_FILENAME "${FILENAME}_debug")
	else (TIGER_DEBUG_BUILD)
		set(PLUGIN_FILENAME "${FILENAME}")
	endif (TIGER_DEBUG_BUILD)
	file(COPY "${QT_HOME2}/plugins/${PLUGIN_DIR}/${PLUGIN_FILENAME}.${LIBEXT}" DESTINATION "${TIGER_BIN_INSTALL}/${PLUGIN_DIR}")
	if (TIGER_DEBUG_BUILD)
		file(RENAME "${TIGER_BIN_INSTALL}/${PLUGIN_DIR}/${PLUGIN_FILENAME}.${LIBEXT}" "${TIGER_BIN_INSTALL}/${PLUGIN_DIR}/${FILENAME}.${LIBEXT}")
	endif (TIGER_DEBUG_BUILD)
endfunction (copy_rename_plugin_files)

message("Copy QtCore")
file(GLOB QTCORE_LIBRARY_FILES "${QT_HOME2}/lib/${QT_CORE_LIBNAME}.*")
file(COPY ${QTCORE_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy QtGui")
file(GLOB QTGUI_LIBRARY_FILES "${QT_HOME2}/lib/${QT_GUI_LIBNAME}.*")
file(COPY ${QTGUI_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy QtXml")
file(GLOB QTXML_LIBRARY_FILES "${QT_HOME2}/lib/${QT_XML_LIBNAME}.*")
file(COPY ${QTXML_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy QtWidgets")
file(GLOB QTWIDGETS_LIBRARY_FILES "${QT_HOME2}/lib/${QT_WIDGETS_LIBNAME}.*")
file(COPY ${QTWIDGETS_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy QtTest")
file(GLOB QTTEST_LIBRARY_FILES "${QT_HOME2}/lib/${QT_TEST_LIBNAME}.*")
file(COPY ${QTTEST_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy QtPrintSupport")
file(GLOB QTPRINTSUPPORT_LIBRARY_FILES "${QT_HOME2}/lib/${QT_PRINTSUPPORT_LIBNAME}.*")
file(COPY ${QTPRINTSUPPORT_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

copy_rename_plugin_files("libqcocoa" "platforms")
copy_rename_plugin_files("libqjpeg" "imageformats")
copy_rename_plugin_files("libqgif" "imageformats")
copy_rename_plugin_files("libcocoaprintersupport" "printsupport")

message("Copy libxml2")
file(GLOB LIBXML_LIBRARY_FILES "${LIBXML_HOME}/lib/${LIBXML_LIBNAME}.${LIBEXT}*")
file(COPY ${LIBXML_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy UPnP")
file(GLOB LIBUPNP_LIBRARY_FILES "${LIBUPNP_HOME}/lib/*.${LIBEXT}*")
file(COPY ${LIBUPNP_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy Musepack Decoder")
file(GLOB MUSEPACK_LIBRARY_FILES "${MUSEPACK_HOME}/lib/*.${LIBEXT}*")
file(COPY ${MUSEPACK_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy WavPack")
file(GLOB WAVPACK_LIBRARY_FILES "${WAVPACK_HOME}/lib/${WAVPACK_LIBNAME}.${LIBEXT}*")
file(COPY ${WAVPACK_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy GTest")
file(GLOB GTEST_LIBRARY_FILES "${GTEST_HOME}/lib/*.${LIBEXT}*")
file(COPY ${GTEST_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})

message("Copy GMock")
file(GLOB GMOCK_LIBRARY_FILES "${GMOCK_HOME}/lib/*.${LIBEXT}*")
file(COPY ${GMOCK_LIBRARY_FILES} DESTINATION ${TIGER_BIN_INSTALL})
